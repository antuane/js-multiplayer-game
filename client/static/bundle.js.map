{"version":3,"sources":["webpack:///webpack/bootstrap 831be400c2a7c098dff1","webpack:///./client/src/main.js","webpack:///./client/src/controllers/GameController.js","webpack:///./client/src/services/GameService.js"],"names":["GameController","require","window","gameController","Error","GameService","global","console","log","HTMLCanvasElement","WebSocket","$","document","querySelector","bind","_canvas","gameService","_init","loadingGame","setInterval","config","_run","clearInterval","FPS","module","exports","socket","io","connect","socketId","listen","on","data","playerId","player","id","playerAction","angle","world","startGame","ranking","name","emit"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;AC7DA,IAAIA,iBAAiB,mBAAAC,CAAQ,CAAR,CAArB;;AAEA,IAAGC,MAAH,EAAU;AACN,QAAMC,iBAAiB,IAAIH,cAAJ,CAAmBE,MAAnB,CAAvB;AACH,CAFD,MAEO;AACH,UAAM,IAAIE,KAAJ,CAAU,0BAAV,CAAN;AACH;;AAID;;;AAKA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;;AAIA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,Q;;;;;;;ACrQA;;;;;;AAEA,IAAIC,cAAc,mBAAAJ,CAAQ,CAAR,CAAlB;;IAEMD,c;AACF,4BAAYM,MAAZ,EAAmB;AAAA;;AAEfC,gBAAQC,GAAR,CAAYF,MAAZ;AACA,YAAG,EAAEA,OAAOG,iBAAP,IAA4BH,OAAOI,SAArC,CAAH,EAAmD;AAC/C,kBAAM,IAAIN,KAAJ,CAAU,0BAAV,CAAN;AACH;;AAED,YAAIO,IAAIC,SAASC,aAAT,CAAuBC,IAAvB,CAA4BF,QAA5B,CAAR;AACA,aAAKG,OAAL,GAAeJ,EAAE,SAAF,CAAf;AACA,aAAKK,WAAL,GAAmB,IAAIX,WAAJ,CAAgBC,MAAhB,CAAnB;AACA,aAAKW,KAAL;AACH;;;;gCAEO;AAAA;;AAEJ,gBAAIC,cAAcC,YAAY,YAAM;AAChC,oBAAG,MAAKH,WAAL,CAAiBI,MAApB,EAA2B;AACvB,0BAAKC,IAAL;AACAC,kCAAcJ,WAAd;AACH;AACJ,aALiB,EAKf,GALe,CAAlB;AAMH;;;+BAEM;;AAEH,gBAAIE,SAAS,KAAKJ,WAAL,CAAiBI,MAA9B;AACAD,wBAAY,YAAM;AACd;AACAZ,wBAAQC,GAAR,CAAY,YAAZ;AACH,aAHD,EAGG,OAAOY,OAAOG,GAHjB;AAIH;;;;;;AAGLC,OAAOC,OAAP,GAAiBzB,cAAjB,C;;;;;;;ACtCA;;;;;;IAEMK,W;AACF,yBAAYC,MAAZ,EAAoB;AAAA;;AAEhB,aAAKoB,MAAL,GAAcpB,OAAOqB,EAAP,CAAUC,OAAV,EAAd;AACA,aAAKC,QAAL;AACA,aAAKT,MAAL;AACA,aAAKU,MAAL;AACH;;;;iCAEQ;AAAA;;AAEL,iBAAKJ,MAAL,CAAYK,EAAZ,CAAe,WAAf,EAA4B,gBAAQ;AAChC,sBAAKF,QAAL,GAAgBG,KAAKH,QAArB;AACA,sBAAKT,MAAL,GAAcY,KAAKZ,MAAnB;AACAb,wBAAQC,GAAR,CAAY,QAAZ,EAAsBwB,IAAtB,EAA4B,YAA5B;AACH,aAJD;;AAMA,iBAAKN,MAAL,CAAYK,EAAZ,CAAe,SAAf,EAA0B,gBAAQ;AAC9BX,yBAASY,KAAKZ,MAAd;AACAa,2BAAWD,KAAKE,MAAL,CAAYC,EAAvB;AACAC,6BAAaC,KAAb,GAAqBL,KAAKE,MAAL,CAAYG,KAAjC;AACAC,wBAAQN,KAAKM,KAAb;AACAC;AACH,aAND;;AAQA,iBAAKb,MAAL,CAAYK,EAAZ,CAAe,QAAf,EAAyB,gBAAQ;AAC7BE,2BAAWD,KAAKE,MAAL,CAAYC,EAAvB;AACAG,wBAAQN,KAAKM,KAAb;AACAE,0BAAUR,KAAKQ,OAAf;AACH,aAJD;AAMH;;;8BAEKC,I,EAAM;AACR,iBAAKf,MAAL,CAAYgB,IAAZ,CAAiB,OAAjB,EAA0B,EAAED,UAAF,EAA1B;AACH;;;;;;AAGLjB,OAAOC,OAAP,GAAiBpB,WAAjB,C","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 831be400c2a7c098dff1","let GameController = require('./controllers/GameController')\n\nif(window){\n    const gameController = new GameController(window);\n} else {\n    throw new Error(\"Object window not found.\")\n}\n\n\n\n// import { drawPoligon, drawPlayer } from './utils/canvas-util'\n\n\n\n\n//     let canvas, context, socket, playerId, playerAction, world, config, ranking, gameEngine, socketEngine;\n\n//     const PREDICTION = 6;\n\n//     const playerImage = new Image(64, 64);\n//     playerImage.src = '/static/img/player.png';\n    \n//     window.addEventListener(\"load\", init, false);\n//     window.addEventListener(\"resize\", resize, false);\n\n//     function init() {\n        \n//         canvas = document.getElementById('canvas');\n//         if(canvas && \"WebSocket\" in window){\n            \n//             canvas.width  = window.innerWidth | document.body.clientWidth;;\n//             canvas.height = window.innerHeight | document.body.clientHeight;;\n//             context = canvas.getContext(\"2d\");\n//             socket = window.io.connect();\n            \n//             bindEvents();\n\n//             const playerName = prompt(\"Digite seu Nick\", \"Guest\");\n            \n//             socket.on('connect', function (data) {\n//                 clearInterval(socketEngine);\n//                 clearInterval(gameEngine);\n//                 socket.emit('start-game', { name: playerName});\n//             });\n\n//             socket.on('player-connected', function (data) {\n//                 config = data.config;\n//                 playerId = data.player.id;\n//                 playerAction.angle = data.player.angle;\n//                 world = data.world;\n//                 startGame();\n//             });            \n\n//             socket.on('update', function(data){\n//                 playerId = data.player.id;\n//                 world = data.world;\n//                 ranking = data.ranking;\n//             });\n            \n//         } else {\n//             alert(\"Seu navegador não suporta WebSocket\");\n//         }\n//     }\n\n//     function resize(){\n//         canvas.width  = window.innerWidth | document.body.clientWidth;;\n//         canvas.height = window.innerHeight | document.body.clientHeight;;\n//     }\n\n//     function startGame() {       \n//         gameEngine = setInterval(function(){\n//             update();\n//         }, 1000 / (config.FPS * PREDICTION));\n\n//         socketEngine = setInterval(function(){\n//             socket.emit('update', playerAction);\n//         }, 1000 / (config.FPS));\n//     }\n\n//     function update() {\n\n//         let diffX = 0;\n//         let diffY = 0;\n\n//         world.shots.forEach(shot => {\n//             shot.x += (config.SHOT_VELOCITY / PREDICTION) * Math.cos((shot.angle) * (Math.PI / 180));\n//             shot.y += (config.SHOT_VELOCITY / PREDICTION) * Math.sin((shot.angle) * (Math.PI / 180));\n//         });\n\n//         world.players.forEach(player => {\n//             player.x += (player.velocity / PREDICTION) * Math.cos((player.angle) * (Math.PI / 180));\n//             if(player.x > config.WORLD.width) player.x = 0;\n//             else if(player.x < 0) player.x = config.WORLD.width;\n\n//             player.y += (player.velocity / PREDICTION) * Math.sin((player.angle) * (Math.PI / 180));\n//             if(player.y > config.WORLD.height) player.y = 0;\n//             else if(player.y < 0) player.y = config.WORLD.height;\n\n//             if(player.id == playerId) {\n\n//                 if(playerAction.up){\n//                     player.acceleration += config.PLAYER_ACCELERATION / PREDICTION;\n//                     if (player.acceleration > config.PLAYER_MAX_VELOCITY) player.acceleration = config.PLAYER_MAX_VELOCITY;\n//                 } \n                \n//                 if (playerAction.down) {\n//                     player.acceleration -= config.PLAYER_ACCELERATION / PREDICTION;\n//                     if (player.acceleration < config.PLAYER_MIN_VELOCITY) player.acceleration = config.PLAYER_MIN_VELOCITY;\n//                 }\n    \n//                 if (playerAction.left) {\n//                     playerAction.angle -= 1;\n//                     if (playerAction.angle < 0) playerAction.angle = 360;\n//                 }\n    \n//                 if (playerAction.right) {\n//                     playerAction.angle += 1;\n//                     if (playerAction.angle > 360) playerAction.angle = 0;\n//                 }\n\n//                 let centerX = (canvas.width / 2);\n//                 let centerY = (canvas.height / 2);\n\n//                 diffX = centerX - player.x;\n//                 diffY = centerY - player.y;\n//             }\n//         });\n\n\n\n//         draw(diffX, diffY);\n\n//     }\n\n//     function draw(diffX, diffY){\n//         if(world) {\n//             context.clearRect (0 ,0 , canvas.width, canvas.height );\n//             context.strokeStyle = \"#222\";\n//             context.lineWidth = 3;\n//             context.beginPath();\n//             context.strokeRect(diffX, diffY, config.WORLD.width, config.WORLD.height);\n\n//             const distanceLine = 50;\n\n//             for (let index = 0; index < (config.WORLD.width / distanceLine); index++) {\n//                 context.strokeRect(index * distanceLine + diffX, diffY, distanceLine, config.WORLD.height);\n//                 context.strokeRect(diffX, index * distanceLine + diffY, config.WORLD.width, distanceLine);\n//             }\n//             context.stroke();\n\n//             let centerX = (canvas.width / 2);\n//             let centerY = (canvas.height / 2);\n\n//             world.shots.forEach(shot => {\n//                 const x = shot.x + diffX;\n//                 const y = shot.y + diffY;\n\n//                 context.fillStyle = shot.color;\n//                 context.beginPath();\n//                 context.arc(x,y,10,0,2*Math.PI);\n//                 context.fill();\n//             });\n\n//             world.players.forEach(player => {\n//                 if(player.live){\n//                     const size = (player.width + player.height) / 2;\n//                     const x = player.x + diffX;\n//                     const y = player.y + diffY;\n//                     drawPlayer(context, player, x, y);\n//                     context.font = '10px Arial';\n//                     context.textAlign = 'center';\n//                     context.fillStyle = '#ffffff';\n//                     context.fillText(player.name, player.x + diffX, player.y + (player.height * 2) + diffY);\n//                 }\n//             });\n\n//             let rankBox = {\n//                 width: 300,\n//                 height: canvas.height - 20,\n//                 x:canvas.width - (15 + 300),\n//                 y: 10\n//             }\n\n//             context.fillStyle = \"rgba(0,0,0,0.8)\";\n//             context.fillRect(rankBox.x, rankBox.y, rankBox.width, rankBox.height);\n\n//             context.textAlign = 'left';\n//             context.fillStyle = \"#ffffff\";\n//             context.font = \"20px Arial\";\n//             context.fillText(\"TOP RANKING: \",rankBox.x + 30,150);\n//             context.font = \"16px Arial\";\n//             if(ranking) {\n//                 ranking.forEach((rank, i) => {\n//                     context.fillText(i + \" - \" + rank.name + \" ( \" + rank.kills + \" pts )\",rankBox.x + 50,180 + (i*20));\n//                 });\n//             }\n//         }\n//         else{\n//             console.error(\"world not found\");\n//         }\n//     };\n\n//     function bindEvents() {\n//         playerAction = {\n//             \"up\": false,\n//             \"left\": false,\n//             \"right\": false,\n//             \"down\": false,\n//             \"atack\": false,\n//         };\n\n//         function keyDownEvent (e) {\n//             let keyCode = e.keyCode;\n\n//             if(keyCode == 37 || keyCode == 65){\n//                 playerAction.left = true;\n//             }\n\n//             if(keyCode == 39 || keyCode == 68){\n//                 playerAction.right = true;\n//             }\n\n//             if(keyCode == 38 || keyCode == 87){\n//                 playerAction.up = true;\n//             }\n\n//             if(keyCode == 40 || keyCode == 83){\n//                 playerAction.down = true;\n//             }\n\n//             if(keyCode == 32){\n//                 playerAction.fire = true;\n//             }\n//         };\n\n//         function keyUpEvent (e) {\n//             let keyCode = e.keyCode;\n\n//             if(keyCode == 37 || keyCode == 65){\n//                 playerAction.left = false;\n//             }\n            \n//             if(keyCode == 39 || keyCode == 68){\n//                 playerAction.right = false;\n//             }\n\n//             if(keyCode == 38 || keyCode == 87){\n//                 playerAction.up = false;\n//             }\n\n//             if(keyCode == 40 || keyCode == 83){\n//                 playerAction.down = false;\n//             }\n\n//             if(keyCode == 32){\n//                 playerAction.fire = false;\n//             }\n//         };\n\n//         document.addEventListener(\"keydown\", keyDownEvent, false);\n//         document.addEventListener(\"keyup\", keyUpEvent, false);\n//     }\n\n\n// WEBPACK FOOTER //\n// ./client/src/main.js","'use strict';\n\nlet GameService = require('../services/GameService'); \n\nclass GameController {\n    constructor(global){\n\n        console.log(global);\n        if(!(global.HTMLCanvasElement && global.WebSocket)){\n            throw new Error('O navegador não suporta!');\n        }\n\n        let $ = document.querySelector.bind(document);\n        this._canvas = $('#canvas');\n        this.gameService = new GameService(global);\n        this._init();\n    }\n\n    _init() {\n\n        let loadingGame = setInterval(() => {\n            if(this.gameService.config){\n                this._run();\n                clearInterval(loadingGame);\n            }\n        }, 200);\n    }\n\n    _run() {\n\n        let config = this.gameService.config;        \n        setInterval(() => {\n            //this.gameService.update();\n            console.log(\"Loop start\");\n        }, 1000 / config.FPS);\n    }\n}\n\nmodule.exports = GameController\n\n\n// WEBPACK FOOTER //\n// ./client/src/controllers/GameController.js","'use strict';\n\nclass GameService {\n    constructor(global) {\n        \n        this.socket = global.io.connect();\n        this.socketId;\n        this.config;\n        this.listen();\n    }\n\n    listen() {\n\n        this.socket.on('connected', data => {\n            this.socketId = data.socketId;\n            this.config = data.config;\n            console.log('Player', data, 'connected!')\n        });\n\n        this.socket.on('started', data => {\n            config = data.config;\n            playerId = data.player.id;\n            playerAction.angle = data.player.angle;\n            world = data.world;\n            startGame();\n        });            \n\n        this.socket.on('update', data => {\n            playerId = data.player.id;\n            world = data.world;\n            ranking = data.ranking;\n        });\n\n    }\n\n    start(name) {\n        this.socket.emit('start', { name });\n    }\n}\n\nmodule.exports = GameService;\n\n\n// WEBPACK FOOTER //\n// ./client/src/services/GameService.js"],"sourceRoot":""}